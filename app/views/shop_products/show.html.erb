<div class="container pt-5 pb-5">
  <h1 class="text-center mb-5"><%= @product.name %></h1>

<div class="product-container">
    <div style="width: 50%; margin-bottom: 2em">
        <div class="text-center">
            <% if @product.images.attached? %>
            <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                <% @product.images.each_with_index do |image, index| %>
                    <div class="carousel-item <%= 'active' if index == 0 %>">
                    <%= image_tag image, class: "d-block w-100", alt: "Imagen de #{@product.name}" %>
                    </div>
                <% end %>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
                </button>
            </div>
            <% else %>
            <img src="https://via.placeholder.com/600x400" alt="Imagen no disponible" class="img-fluid" />
            <% end %>
        </div>

        <p class="mt-4"><%= @product.description %></p>

        <h3 class="mt-3"><%= number_to_currency(@product.unit_price) %></h3>
    </div>

    <div class="elements-container">
        <div class="element-container">
            <h3>Talles</h3>
            <div class="d-flex flex-wrap mt-4" role="group" aria-label="Basic radio toggle button group">
            <% @product.size_stocks.each do |size_stock| %>
                <input type="radio" class="btn-check" name="size" id="size_<%= size_stock.id %>" autocomplete="off" checked="" <%= "disabled" if size_stock.stock_available == 0 %>>
                <label class="btn btn-outline-primary" for="size_<%= size_stock.id %>">
                <%= size_stock.size.size %> 
                </label>
            <% end %>
            </div>
        </div>
  
        <div class="element-container">
            <h3>Cantidad</h3>
            <div class="d-flex mt-3">
                <div>
                    <button class="btn btn-outline-secondary" type="button" id="decreaseQuantity">-</button>
                </div>
                <div style="width: 60px;">
                    <input type="text" class="form-control text-center" id="quantity" value="0" min="0" style="width: 60px; height: 40px; padding: 0 10px;" />
                </div>
                <div>
                    <button class="btn btn-outline-secondary" type="button" id="increaseQuantity">+</button>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <button class="btn btn-lg btn-primary" id="addToCart">Agregar al carrito</button>
        </div>
        </div>
    </div>

    <div class="mt-4">
        <%= link_to 'Volver', shop_products_path, class:"btn btn-link" %>
    </div>

</div>
<script>
  // Incrementar y decrementar cantidad
  document.getElementById('increaseQuantity').addEventListener('click', function() {
    const quantityInput = document.getElementById('quantity');
    quantityInput.value = parseInt(quantityInput.value) + 1;
  });

  document.getElementById('decreaseQuantity').addEventListener('click', function() {
    const quantityInput = document.getElementById('quantity');
    if (parseInt(quantityInput.value) > 0) {
      quantityInput.value = parseInt(quantityInput.value) - 1;
    }
  });

  // Agregar al carrito (puedes adaptar esto a tu lógica de carrito)
  document.getElementById('addToCart').addEventListener('click', function() {
    const quantity = document.getElementById('quantity').value;
    const size = document.querySelector('input[name="size"]:checked');
    if (size && quantity > 0) {
      alert(`Producto: ${size.nextElementSibling.innerText}, Cantidad: ${quantity}`);
    } else {
      alert("Selecciona un talle y cantidad válida.");
    }
  });
</script>